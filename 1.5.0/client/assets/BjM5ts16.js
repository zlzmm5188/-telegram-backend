import{r as e,j as t,u as n}from"./CNfpgpjz.js";import{d as r}from"./CMXE0X62.js";import{w as o,F as a}from"./BNFXpl3F.js";import{i as l,g as s,K as i,u as c,a as p,C as d,F as m,P as u,r as g,M as f,b as x,c as h,w as y,d as v,e as b,f as C,h as j,m as O,j as S,k as w,l as P,R as $,A as E}from"./22C-TE4c.js";import{g as N,m as I,r as k,C as z,c as T,a as B,B as W,b as _,l as D,o as F}from"./Cl-LLmMt.js";import{g as R,P as V,a as M,b as A,c as H,u as L,T as Y,F as U,I as K}from"./CmOOvI3R.js";import{a as X,k as G,u as q,l as J}from"./Udhf45Dc.js";const Q=e=>e?"function"==typeof e?e():e:null,Z=e=>{const{componentCls:t,popoverColor:n,titleMinWidth:r,fontWeightStrong:o,innerPadding:a,boxShadowSecondary:l,colorTextHeading:s,borderRadiusLG:i,zIndexPopup:c,titleMarginBottom:p,colorBgElevated:d,popoverBg:m,titleBorderBottom:u,innerContentPadding:g,titlePadding:f}=e;return[{[t]:Object.assign(Object.assign({},k(e)),{position:"absolute",top:0,left:{_skip_check_:!0,value:0},zIndex:c,fontWeight:"normal",whiteSpace:"normal",textAlign:"start",cursor:"auto",userSelect:"text","--valid-offset-x":"var(--arrow-offset-horizontal, var(--arrow-x))",transformOrigin:["var(--valid-offset-x, 50%)","var(--arrow-y, 50%)"].join(" "),"--antd-arrow-background-color":d,width:"max-content",maxWidth:"100vw","&-rtl":{direction:"rtl"},"&-hidden":{display:"none"},[`${t}-content`]:{position:"relative"},[`${t}-inner`]:{backgroundColor:m,backgroundClip:"padding-box",borderRadius:i,boxShadow:l,padding:a},[`${t}-title`]:{minWidth:r,marginBottom:p,color:s,fontWeight:o,borderBottom:u,padding:f},[`${t}-inner-content`]:{color:n,padding:g}})},R(e,"var(--antd-arrow-background-color)"),{[`${t}-pure`]:{position:"relative",maxWidth:"none",margin:e.sizePopupArrow,display:"inline-block",[`${t}-content`]:{display:"inline-block"}}}]},ee=e=>{const{componentCls:t}=e;return{[t]:V.map((n=>{const r=e[`${n}6`];return{[`&${t}-${n}`]:{"--antd-arrow-background-color":r,[`${t}-inner`]:{backgroundColor:r},[`${t}-arrow`]:{background:"transparent"}}}}))}},te=N("Popover",(e=>{const{colorBgElevated:t,colorText:n}=e,r=I(e,{popoverBg:t,popoverColor:n});return[Z(r),ee(r),l(r,"zoom-big")]}),(e=>{const{lineWidth:t,controlHeight:n,fontHeight:r,padding:o,wireframe:a,zIndexPopupBase:l,borderRadiusLG:s,marginXS:i,lineType:c,colorSplit:p,paddingSM:d}=e,m=n-r,u=m/2,g=m/2-t,f=o;return Object.assign(Object.assign(Object.assign({titleMinWidth:177,zIndexPopup:l+30},M(e)),A({contentRadius:s,limitVerticalRadius:!0})),{innerPadding:a?0:12,titleMarginBottom:a?0:i,titlePadding:a?`${u}px ${f}px ${g}px`:0,titleBorderBottom:a?`${t}px ${c} ${p}`:"none",innerContentPadding:a?`${d}px ${f}px`:0})}),{resetStyle:!1,deprecatedTokens:[["width","titleMinWidth"],["minWidth","titleMinWidth"]]});const ne=t=>{let{title:n,content:r,prefixCls:o}=t;return n||r?e.createElement(e.Fragment,null,n&&e.createElement("div",{className:`${o}-title`},n),r&&e.createElement("div",{className:`${o}-inner-content`},r)):null},re=t=>{const{hashId:n,prefixCls:r,className:o,style:a,placement:l="top",title:s,content:i,children:c}=t,p=Q(s),d=Q(i),m=T(n,r,`${r}-pure`,`${r}-placement-${l}`,o);return e.createElement("div",{className:m,style:a},e.createElement("div",{className:`${r}-arrow`}),e.createElement(H,Object.assign({},t,{className:n,prefixCls:r}),c||e.createElement(ne,{prefixCls:r,title:p,content:d})))},oe=t=>{const{prefixCls:n,className:r}=t,o=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]])}return n}(t,["prefixCls","className"]),{getPrefixCls:a}=e.useContext(z),l=a("popover",n),[s,i,c]=te(l);return s(e.createElement(re,Object.assign({},o,{prefixCls:l,hashId:i,className:T(r,c)})))};const ae=e.forwardRef(((t,n)=>{var r,o;const{prefixCls:a,title:l,content:c,overlayClassName:p,placement:d="top",trigger:m="hover",children:u,mouseEnterDelay:g=.1,mouseLeaveDelay:f=.1,onOpenChange:x,overlayStyle:h={}}=t,y=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]])}return n}(t,["prefixCls","title","content","overlayClassName","placement","trigger","children","mouseEnterDelay","mouseLeaveDelay","onOpenChange","overlayStyle"]),{getPrefixCls:v}=e.useContext(z),b=v("popover",a),[C,j,O]=te(b),S=v(),w=T(p,j,O),[P,$]=L(!1,{value:null!==(r=t.open)&&void 0!==r?r:t.visible,defaultValue:null!==(o=t.defaultOpen)&&void 0!==o?o:t.defaultVisible}),E=(e,t)=>{$(e,!0),null==x||x(e,t)},N=Q(l),I=Q(c);return C(e.createElement(Y,Object.assign({placement:d,trigger:m,mouseEnterDelay:g,mouseLeaveDelay:f,overlayStyle:h},y,{prefixCls:b,overlayClassName:w,ref:n,open:P,onOpenChange:e=>{E(e)},overlay:N||I?e.createElement(ne,{prefixCls:b,title:N,content:I}):null,transitionName:s(S,"zoom-big",y.transitionName),"data-popover-inject":!0}),B(u,{onKeyDown:t=>{var n,r;e.isValidElement(u)&&(null===(r=null==u?void 0:(n=u.props).onKeyDown)||void 0===r||r.call(n,t)),(e=>{e.keyCode===i.ESC&&E(!1,e)})(t)}})))}));ae._InternalPanelDoNotUseOrYouWillBeFired=oe;const le=o((t=>{const{prefixCls:n,className:r,closeIcon:o,closable:a,type:l,title:s,children:i,footer:f}=t,x=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]])}return n}(t,["prefixCls","className","closeIcon","closable","type","title","children","footer"]),{getPrefixCls:h}=e.useContext(z),y=h(),v=n||h("modal"),b=c(y),[C,j,O]=p(v,b),S=`${v}-confirm`;let w={};return w=l?{closable:null!=a&&a,title:"",footer:"",children:e.createElement(d,Object.assign({},t,{prefixCls:v,confirmPrefixCls:S,rootPrefixCls:y,content:i}))}:{closable:null==a||a,title:s,footer:null!==f&&e.createElement(m,Object.assign({},t)),children:i},C(e.createElement(u,Object.assign({prefixCls:v,className:T(j,`${v}-pure-panel`,l&&S,l&&`${S}-${l}`,r,O,b)},x,{closeIcon:g(v,o),closable:a},w)))}));function se(e){return h(S(e))}const ie=f;ie.useModal=x,ie.info=function(e){return h(y(e))},ie.success=function(e){return h(v(e))},ie.error=function(e){return h(b(e))},ie.warning=se,ie.warn=se,ie.confirm=function(e){return h(C(e))},ie.destroyAll=function(){for(;j.length;){const e=j.pop();e&&e()}},ie.config=O,ie._InternalPanelDoNotUseOrYouWillBeFired=le;const ce=N("Popconfirm",(e=>(e=>{const{componentCls:t,iconCls:n,antCls:r,zIndexPopup:o,colorText:a,colorWarning:l,marginXXS:s,marginXS:i,fontSize:c,fontWeightStrong:p,colorTextHeading:d}=e;return{[t]:{zIndex:o,[`&${r}-popover`]:{fontSize:c},[`${t}-message`]:{marginBottom:i,display:"flex",flexWrap:"nowrap",alignItems:"start",[`> ${t}-message-icon ${n}`]:{color:l,fontSize:c,lineHeight:1,marginInlineEnd:i},[`${t}-title`]:{fontWeight:p,color:d,"&:only-child":{fontWeight:"normal"}},[`${t}-description`]:{marginTop:s,color:a}},[`${t}-buttons`]:{textAlign:"end",whiteSpace:"nowrap",button:{marginInlineStart:i}}}}})(e)),(e=>{const{zIndexPopupBase:t}=e;return{zIndexPopup:t+60}}),{resetStyle:!1});const pe=t=>{const{prefixCls:n,okButtonProps:r,cancelButtonProps:o,title:a,description:l,cancelText:s,okText:i,okType:c="primary",icon:p=e.createElement($,null),showCancel:d=!0,close:m,onConfirm:u,onCancel:g,onPopupClick:f}=t,{getPrefixCls:x}=e.useContext(z),[h]=w("Popconfirm",D.Popconfirm),y=Q(a),v=Q(l);return e.createElement("div",{className:`${n}-inner-content`,onClick:f},e.createElement("div",{className:`${n}-message`},p&&e.createElement("span",{className:`${n}-message-icon`},p),e.createElement("div",{className:`${n}-message-text`},y&&e.createElement("div",{className:`${n}-title`},y),v&&e.createElement("div",{className:`${n}-description`},v))),e.createElement("div",{className:`${n}-buttons`},d&&e.createElement(W,Object.assign({onClick:g,size:"small"},o),s||(null==h?void 0:h.cancelText)),e.createElement(P,{buttonProps:Object.assign(Object.assign({size:"small"},_(c)),r),actionFn:u,close:m,prefixCls:x("btn"),quitOnNullishReturnValue:!0,emitEvent:!0},i||(null==h?void 0:h.okText))))};const de=e.forwardRef(((t,n)=>{var r,o;const{prefixCls:a,placement:l="top",trigger:s="click",okType:i="primary",icon:c=e.createElement($,null),children:p,overlayClassName:d,onOpenChange:m,onVisibleChange:u}=t,g=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]])}return n}(t,["prefixCls","placement","trigger","okType","icon","children","overlayClassName","onOpenChange","onVisibleChange"]),{getPrefixCls:f}=e.useContext(z),[x,h]=L(!1,{value:null!==(r=t.open)&&void 0!==r?r:t.visible,defaultValue:null!==(o=t.defaultOpen)&&void 0!==o?o:t.defaultVisible}),y=(e,t)=>{h(e,!0),null==u||u(e),null==m||m(e,t)},v=f("popconfirm",a),b=T(v,d),[C]=ce(v);return C(e.createElement(ae,Object.assign({},F(g,["title"]),{trigger:s,placement:l,onOpenChange:(e,n)=>{const{disabled:r=!1}=t;r||y(e,n)},open:x,ref:n,overlayClassName:b,content:e.createElement(pe,Object.assign({okType:i,icon:c},t,{prefixCls:v,close:e=>{y(!1,e)},onConfirm:e=>{var n;return null===(n=t.onConfirm)||void 0===n?void 0:n.call(void 0,e)},onCancel:e=>{var n;y(!1,e),null===(n=t.onCancel)||void 0===n||n.call(void 0,e)}})),"data-popover-inject":!0}),p))}));de._InternalPanelDoNotUseOrYouWillBeFired=t=>{const{prefixCls:n,placement:r,className:o,style:a}=t,l=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]])}return n}(t,["prefixCls","placement","className","style"]),{getPrefixCls:s}=e.useContext(z),i=s("popconfirm",n),[c]=ce(i);return c(e.createElement(oe,{placement:r,className:T(i,o),style:a,content:e.createElement(pe,Object.assign({prefixCls:i},l))}))};const me=["20","40","60","80","100"],ue={x:1e3,y:"calc(100vh - 280px)"},ge=({created_at:e})=>{return t.jsx("div",{children:t.jsxs("div",{children:["创建时间: ",(n=e,r(1e3*n).format("YYYY-MM-DD HH:mm:ss"))]})});var n},fe=[{title:"序号",dataIndex:"id",width:100},{title:"用户名",dataIndex:"username"},{title:"邀请码",dataIndex:"invite_code"},{title:"",width:260,render:(e,n)=>t.jsx(ge,{...n})}],xe=e.memo((function({data:e,total:n,onChange:r,pageSize:o,current:l,onDelete:s}){return t.jsx(a,{scroll:ue,rowKey:e=>e.id.toString(),columns:[...fe,{title:"操作",width:120,render:(e,n)=>t.jsx(de,{title:"确认删除",description:"确定要删除这个代理吗？",onConfirm:()=>s(n.id),okText:"确定",cancelText:"取消",children:t.jsx(W,{danger:!0,size:"small",children:"删除"})})}],dataSource:e,locale:{filterTitle:"筛选",filterConfirm:"确定",filterReset:"重置",filterEmptyText:"无筛选项",filterCheckall:"全选",filterSearchPlaceholder:"在筛选项中搜索",selectAll:"全选当页",selectInvert:"反选当页",selectNone:"清空所有",selectionAll:"全选所有",sortTitle:"排序",expand:"展开行",collapse:"关闭行",triggerDesc:"点击降序",triggerAsc:"点击升序",cancelSort:"取消排序",emptyText:"无数据"},pagination:{pageSize:o,showSizeChanger:!0,pageSizeOptions:me,showTotal:e=>`共 ${e} 条`,total:n,current:l,onChange:r,locale:{items_per_page:"条/页",jump_to:"跳至",jump_to_confirm:"确定",page:"页",prev_page:"上一页",next_page:"下一页",prev_5:"向前5页",next_5:"向后5页",prev_3:"向前3页",next_3:"向后3页",page_size:"条"}}})}));function he(){const[n,r]=e.useState(!1),[o]=U.useForm(),a=X();return t.jsxs(t.Fragment,{children:[t.jsx(ie,{title:"创建代理",open:n,onCancel:()=>{o.resetFields(),r(!1)},transitionName:"",onOk:()=>o.submit(),children:t.jsxs(U,{name:"create-agent",onFinish:async e=>{a({...e,intent:"create"},{method:"post",action:"/agent"})},layout:"vertical",form:o,children:[t.jsx(U.Item,{label:"用户名",name:"username",children:t.jsx(K,{})}),t.jsx(U.Item,{label:"密码",name:"password",children:t.jsx(K.Password,{})})]})}),t.jsx(W,{onClick:()=>r(!0),children:"创建代理"})]})}function ye({initialValues:n,onSearch:r,onReset:o}){const[a]=U.useForm();return e.useEffect((()=>{a.setFieldsValue({username:n.username})}),[n,a]),t.jsx("div",{className:"flex items-center justify-center p-4",children:t.jsxs(U,{form:a,className:"!space-x-4",layout:"inline",style:{maxWidth:"none"},onFinish:r,onReset:o,initialValues:{username:n.username},children:[t.jsx(U.Item,{name:"username",children:t.jsx(K,{placeholder:"用户名"})}),t.jsxs(U.Item,{children:[t.jsx(W,{type:"primary",htmlType:"submit",children:"搜索"}),t.jsx(W,{type:"dashed",htmlType:"reset",children:"重置"})]})]})})}function ve(){const{agent_rows:r,total:o,page:a,pageSize:l,username:s}=G(),i=n(),c=X(),{handleSearch:p,handlePagination:d}=(e=>{const[t]=J(),r=n();return{handleSearch:t=>{const n=new URLSearchParams({page:"1",pageSize:String(e)});Object.entries(t).forEach((([e,t])=>{t&&n.set(e,t)})),r(`?${n}`)},handlePagination:(n,o)=>{const a=new URLSearchParams({page:String(o!==e?1:n),pageSize:String(o)}),l=t.get("username");l&&a.set("username",l),r(`?${a}`)}}})(l),{message:m}=E.useApp(),u=q();return e.useEffect((()=>{u&&((null==u?void 0:u.success)&&m.success("操作成功"),(null==u?void 0:u.error)&&m.error(u.error))}),[u]),t.jsxs(t.Fragment,{children:[t.jsx(ye,{initialValues:{username:s},onSearch:p,onReset:()=>i(`?page=1&pageSize=${l}`)}),t.jsx("div",{className:"ml-4",children:t.jsx(he,{})}),t.jsx("div",{className:"p-4",children:t.jsx(xe,{onDelete:e=>{const t=new FormData;t.append("intent","delete"),t.append("id",e.toString()),c(t,{method:"post"})},data:r,total:o,current:a,pageSize:l,onChange:d})})]})}export{ve as default};
